{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/yagni/Desktop/my-blog-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/yagni/Desktop/my-blog-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/yagni/Desktop/my-blog-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState}from\"react\";import\"./write.css\";import axios from\"axios\";import{Context}from\"../../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var handlesubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newpost,data,filename,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newpost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newpost.photo=filename;_context.prev=8;_context.next=11;return axios.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axios.post(\"/posts\",newpost);case 18:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,22]]);}));return function handlesubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(file),alt:\"\",className:\"writeimg\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeform\",onSubmit:handlesubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeformgroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileinput\",children:/*#__PURE__*/_jsx(\"i\",{class:\"writeicon fa-solid fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileinput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeinput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeformgroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your Story\",type:\"text\",className:\"writeinput writetext\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writesubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"names":["useContext","useState","axios","Context","Write","title","setTitle","desc","setDesc","file","setFile","user","handlesubmit","e","preventDefault","newpost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","display","target","files","value"],"sources":["C:/Users/yagni/Desktop/my-blog-app/client/src/pages/write/Write.jsx"],"sourcesContent":["import { useContext, useState } from \"react\";\r\nimport \"./write.css\";\r\nimport axios from \"axios\";\r\nimport { Context } from \"../../context/Context\";\r\n\r\nexport default function Write() {\r\n  \r\n  const [title,setTitle] = useState(\"\");\r\n  const [desc,setDesc] = useState(\"\");\r\n  const [file,setFile] = useState(null);\r\n  const {user} =useContext(Context);\r\n\r\n\r\n  const handlesubmit= async (e)=>{\r\n    e.preventDefault();\r\n    const newpost={\r\n      username:user.username,\r\n      title,\r\n      desc,\r\n    };\r\n    if(file){\r\n      const data=new FormData();\r\n      const filename=Date.now()+file.name;\r\n      data.append(\"name\",filename)\r\n      data.append(\"file\",file)\r\n      newpost.photo=filename\r\n      try{\r\n        await axios.post(\"/upload\",data);\r\n      }catch(err){\r\n        \r\n      }\r\n    }\r\n    try{\r\n      const res=await axios.post(\"/posts\",newpost)\r\n      window.location.replace(\"/post/\"+res.data._id)\r\n    }catch(err){\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className='write'>\r\n        {file && \r\n        <img src={URL.createObjectURL(file)} alt=\"\" className=\"writeimg\" />\r\n        }\r\n        <form className=\"writeform\" onSubmit={handlesubmit} >\r\n            <div className=\"writeformgroup\">\r\n                <label htmlFor=\"fileinput\">\r\n                <i class=\"writeicon fa-solid fa-plus\"></i>\r\n                </label>\r\n                <input type=\"file\"  id=\"fileinput\" style={{display:\"none\"}} onChange={e=>setFile(e.target.files[0])}/>\r\n                <input type=\"text\" placeholder=\"Title\" className=\"writeinput\" autoFocus={true} onChange={e=>setTitle(e.target.value)}/>\r\n            </div>\r\n            <div className=\"writeformgroup\">\r\n                <textarea placeholder=\"Tell your Story\" type=\"text\" className=\"writeinput writetext\" onChange={e=>setDesc(e.target.value)}></textarea>\r\n            </div>\r\n            <button className=\"writesubmit\" type=\"submit\">Publish</button>\r\n        </form>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"6YAAA,OAASA,UAAT,CAAqBC,QAArB,KAAqC,OAArC,CACA,MAAO,aAAP,CACA,MAAOC,MAAP,KAAkB,OAAlB,CACA,OAASC,OAAT,KAAwB,uBAAxB,C,wFAEA,cAAe,SAASC,MAAT,EAAiB,CAE9B,cAAyBH,QAAQ,CAAC,EAAD,CAAjC,wCAAOI,KAAP,eAAaC,QAAb,eACA,eAAuBL,QAAQ,CAAC,EAAD,CAA/B,yCAAOM,IAAP,eAAYC,OAAZ,eACA,eAAuBP,QAAQ,CAAC,IAAD,CAA/B,yCAAOQ,IAAP,eAAYC,OAAZ,eACA,gBAAcV,UAAU,CAACG,OAAD,CAAxB,CAAOQ,IAAP,aAAOA,IAAP,CAGA,GAAMC,aAAY,4FAAE,iBAAOC,CAAP,kJAClBA,CAAC,CAACC,cAAF,GACMC,OAFY,CAEJ,CACZC,QAAQ,CAACL,IAAI,CAACK,QADF,CAEZX,KAAK,CAALA,KAFY,CAGZE,IAAI,CAAJA,IAHY,CAFI,KAOfE,IAPe,0BAQVQ,IARU,CAQL,GAAIC,SAAJ,EARK,CASVC,QATU,CASDC,IAAI,CAACC,GAAL,GAAWZ,IAAI,CAACa,IATf,CAUhBL,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAmBJ,QAAnB,EACAF,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAmBd,IAAnB,EACAM,OAAO,CAACS,KAAR,CAAcL,QAAd,CAZgB,uCAcRjB,MAAK,CAACuB,IAAN,CAAW,SAAX,CAAqBR,IAArB,CAdQ,0IAoBAf,MAAK,CAACuB,IAAN,CAAW,QAAX,CAAoBV,OAApB,CApBA,SAoBVW,GApBU,eAqBhBC,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,SAASH,GAAG,CAACT,IAAJ,CAASa,GAA1C,EArBgB,+JAAF,kBAAZlB,aAAY,4CAAlB,CA2BA,mBACE,aAAK,SAAS,CAAC,OAAf,WACKH,IAAI,eACL,YAAK,GAAG,CAAEsB,GAAG,CAACC,eAAJ,CAAoBvB,IAApB,CAAV,CAAqC,GAAG,CAAC,EAAzC,CAA4C,SAAS,CAAC,UAAtD,EAFJ,cAII,cAAM,SAAS,CAAC,WAAhB,CAA4B,QAAQ,CAAEG,YAAtC,wBACI,aAAK,SAAS,CAAC,gBAAf,wBACI,cAAO,OAAO,CAAC,WAAf,uBACA,UAAG,KAAK,CAAC,4BAAT,EADA,EADJ,cAII,cAAO,IAAI,CAAC,MAAZ,CAAoB,EAAE,CAAC,WAAvB,CAAmC,KAAK,CAAE,CAACqB,OAAO,CAAC,MAAT,CAA1C,CAA4D,QAAQ,CAAE,kBAAApB,CAAC,QAAEH,QAAO,CAACG,CAAC,CAACqB,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAT,EAAvE,EAJJ,cAKI,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,OAA/B,CAAuC,SAAS,CAAC,YAAjD,CAA8D,SAAS,CAAE,IAAzE,CAA+E,QAAQ,CAAE,kBAAAtB,CAAC,QAAEP,SAAQ,CAACO,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAV,EAA1F,EALJ,GADJ,cAQI,YAAK,SAAS,CAAC,gBAAf,uBACI,iBAAU,WAAW,CAAC,iBAAtB,CAAwC,IAAI,CAAC,MAA7C,CAAoD,SAAS,CAAC,sBAA9D,CAAqF,QAAQ,CAAE,kBAAAvB,CAAC,QAAEL,QAAO,CAACK,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAT,EAAhG,EADJ,EARJ,cAWI,eAAQ,SAAS,CAAC,aAAlB,CAAgC,IAAI,CAAC,QAArC,qBAXJ,GAJJ,GADF,CAoBD"},"metadata":{},"sourceType":"module"}