{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/yagni/Desktop/my-blog-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/yagni/Desktop/my-blog-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/yagni/Desktop/my-blog-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useContext,useEffect,useState}from\"react\";import{Link,useLocation}from\"react-router-dom\";import{Context}from\"../../context/Context\";import\"./singlepost.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Singlepost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"http://localhost:5000/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),update=_useState8[0],setUpdate=_useState8[1];var hadledelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.delete(\"/posts/\"+path,{data:{username:user.username}});case 3:window.location.replace(\"/\");_context.next=8;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);case 8:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function hadledelete(){return _ref.apply(this,arguments);};}();var handleupdate=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.put(\"/posts/\"+path,{username:user.username,title:title,desc:desc});case 3:// window.location.reload();\nsetUpdate(false);_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleupdate(){return _ref2.apply(this,arguments);};}();useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var res;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context3.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function getPost(){return _ref3.apply(this,arguments);};}();getPost();},[path]);return/*#__PURE__*/_jsx(\"div\",{className:\"singlepost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlepostwrap\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"singlepostimg\"}),update?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlepostinputtitle\",onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singleposttitle\",children:[title,post.username===user.username&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlepostedit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singleposticon fa-solid fa-pen-to-square\",onClick:function onClick(){return setUpdate(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"singleposticon fa-regular fa-trash-can\",onClick:hadledelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlepostinfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlepostauthor\",children:[\" Author:\",/*#__PURE__*/_jsx(Link,{className:\"link\",to:\"/?user=\".concat(post.username),children:/*#__PURE__*/_jsx(\"b\",{children:post.username})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlepostdate\",children:new Date(post.createdAt).toDateString()})]}),update?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlepostinputdesc\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"singlepostdesc\",children:desc}),update&&/*#__PURE__*/_jsx(\"button\",{className:\"singlepostbutton\",onClick:handleupdate,children:\"Update\"})]})});}","map":{"version":3,"names":["axios","useContext","useEffect","useState","Link","useLocation","Context","Singlepost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","update","setUpdate","hadledelete","delete","data","username","window","replace","handleupdate","put","getPost","get","res","photo","e","target","value","Date","createdAt","toDateString"],"sources":["C:/Users/yagni/Desktop/my-blog-app/client/src/comp/singlepost/Singlepost.jsx"],"sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport { Context } from \"../../context/Context\";\r\nimport \"./singlepost.css\"\r\n\r\nexport default function Singlepost() {\r\n  const location = useLocation()\r\n  const path=location.pathname.split(\"/\")[2];\r\n  const [post,setPost]=useState({})\r\n  const PF = \"http://localhost:5000/images/\"\r\n  const {user} =useContext(Context);\r\n  const  [title,setTitle] = useState(\"\")\r\n  const  [desc,setDesc] = useState(\"\")\r\n  const  [update,setUpdate] = useState(false)\r\n\r\n\r\n\r\n  const hadledelete= async()=>{\r\n    try{\r\n      await axios.delete(\"/posts/\"+path,{data:{username:user.username}});\r\n      window.location.replace(\"/\");\r\n    }catch(err){\r\n\r\n    }\r\n  }\r\n\r\n  const handleupdate = async ()=>{\r\n    try{\r\n      await axios.put(\"/posts/\"+path,\r\n      {username:user.username,title,desc});\r\n      // window.location.reload();\r\n      setUpdate(false)\r\n    }catch(err){\r\n\r\n    }\r\n  }\r\n\r\n  useEffect(()=>{\r\n    const getPost = async()=>{\r\n      const res=await axios.get(\"/posts/\"+path);\r\n      setPost(res.data)\r\n      setTitle(res.data.title)\r\n      setDesc(res.data.desc)\r\n    }\r\n    getPost()\r\n  },[path])\r\n  return (\r\n    <div className='singlepost'>\r\n        <div className=\"singlepostwrap\">\r\n        {post.photo && (\r\n          <img src={PF+post.photo} alt=\"\" className=\"singlepostimg\" />\r\n        )}\r\n        {update ? (\r\n          <input type=\"text\" value={title} className=\"singlepostinputtitle\" onChange={(e)=>setTitle(e.target.value)}></input>\r\n        ):\r\n        (\r\n            <h1 className=\"singleposttitle\">{title}\r\n                {post.username === user.username && \r\n      \r\n                <div className=\"singlepostedit\">\r\n                <i className=\"singleposticon fa-solid fa-pen-to-square\" onClick={()=>setUpdate(true)}></i>\r\n                <i className=\"singleposticon fa-regular fa-trash-can\" onClick={hadledelete}></i>\r\n                </div>\r\n                }\r\n            </h1>\r\n        )\r\n        }\r\n            <div className=\"singlepostinfo\">\r\n                <span className=\"singlepostauthor\"> Author:\r\n                  <Link className=\"link\" to={`/?user=${post.username}`}>\r\n                    <b>{post.username}</b>\r\n                  </Link>\r\n                </span>\r\n                <span className=\"singlepostdate\">{new Date(post.createdAt).toDateString()}</span>\r\n            </div>\r\n            {update?<textarea className=\"singlepostinputdesc\"  value={desc} onChange={(e)=>setDesc(e.target.value)}/>:\r\n            <p className=\"singlepostdesc\">{desc}</p>\r\n            }\r\n            {update&&\r\n            <button className=\"singlepostbutton\" onClick={handleupdate}>Update</button>\r\n            }\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}